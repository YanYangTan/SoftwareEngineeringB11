{"remainingRequest":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\src\\components\\GroupPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\src\\components\\GroupPage.vue","mtime":1640180189046},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640099097496},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1640099265001},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640099097496},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1640180123441}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBNZW1iZXJMaXN0IGZyb20gJy4vTWVtYmVyTGlzdC52dWUnOwppbXBvcnQgR2VuZWFsb2d5UGFnZSBmcm9tICcuL0dlbmVhbG9neVBhZ2UudnVlJzsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnR3JvdXBQYWdlJywKICBjb21wb25lbnRzOiB7IEdlbmVhbG9neVBhZ2UsIE1lbWJlckxpc3QgfSwKICBDb21wb25lbnQ6IHsKICAgIE1lbWJlckxpc3QsCiAgICBHZW5lYWxvZ3lQYWdlLAogIH0sCiAgcHJvcHM6IHsKICAgIGluZm86IHt9LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXJpZDogJycsCiAgICAgIGludml0ZWtleTogeyBudW06ICcnLCBleF9kYXRlOiAnJyB9LAogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNoYW5nZUdyb3VwTmFtZSgpIHsKICAgICAgdGhpcy4kcHJvbXB0KCfkuLrkvaDnmoTnvqTmlLnkuIDkuKrlpb3lkKznmoTlkI3lrZcnLCAn576k5ZCN5pu05pS5JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgfSkudGhlbigoeyB2YWx1ZSB9KSA9PiB7CiAgICAgICAgaWYgKHZhbHVlID09PSBudWxsKSB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgICAgICAgdmFsdWUgPSAnJzsKICAgICAgICB9CiAgICAgICAgYXhpb3MucG9zdCgnL2FwaS9jaGFuZ2UtZ3JvdXBuYW1lJywgeyBncm91cF9pZDogdGhpcy4kcHJvcHMuaW5mby5pZCwgbmV3X25hbWU6IHZhbHVlIH0pCiAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFycwogICAgICAgICAgICBsZXQgc3RyOwogICAgICAgICAgICBsZXQgbWVzc2FnZXR5cGU7CiAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXMpIHsKICAgICAgICAgICAgICBtZXNzYWdldHlwZSA9ICdzdWNjZXNzJzsKICAgICAgICAgICAgICBzdHIgPSBg5oiQ5Yqf5pu05pS5576k5ZCN77yM5ZCN5Li677yaJHt2YWx1ZX1gOwogICAgICAgICAgICAgIHRoaXMuJHByb3BzLmluZm8uZ3JvdXBfbmFtZSA9IHZhbHVlOwogICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1lbXB0eQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN0ciA9ICfmm7TmlLnlpLHotKUnOwogICAgICAgICAgICAgIG1lc3NhZ2V0eXBlID0gJ3dhcm5pbmcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6IG1lc3NhZ2V0eXBlLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHN0ciwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgIH0pOwogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5Y+W5raI6L6T5YWlJywKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgY2hlY2tBZG1pbigpIHsKICAgICAgYXhpb3MucG9zdCgnL2FwaS9xdWVyeS1hZG1pbicsIHsgZ3JvdXBfaWQ6IHRoaXMuJHByb3BzLmluZm8uaWQsIHVzZXJfaWQ6IHRoaXMuJHJvdXRlLnBhcmFtcy51c2VyaWQgfSkKICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICBpZiAocmVzLmRhdGEuc3RhdHVzKSB7CiAgICAgICAgICAgIHRoaXMuJHByb3BzLmluZm8uYWRtaW4gPSByZXMuZGF0YS5hZG1pbjsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgIH0pOwogICAgfSwKICAgIERlbGV0ZUdyb3VwKCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgaWYgKGNvbmZpcm0oJ+ehruWumuWIoOmZpOe+pO+8nycpKSB7CiAgICAgICAgYXhpb3MucG9zdCgnL2FwaS9kZWxldGUtZ3JvdXAnLCB7IGdyb3VwX2lkOiB0aGlzLiRwcm9wcy5pbmZvLmlkIH0pCiAgICAgICAgICAudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIGxldCBzdHI7CiAgICAgICAgICAgIGxldCBtZXNzYWdldHlwZTsKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1cykgewogICAgICAgICAgICAgIHN0ciA9ICfmiJDlip/liKDpmaTnvqQnOwogICAgICAgICAgICAgIG1lc3NhZ2V0eXBlID0gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ0JhY2t0b0dyb3VwTGlzdCcpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHN0ciA9ICfliKDpmaTnvqTlpLHotKUnOwogICAgICAgICAgICAgIG1lc3NhZ2V0eXBlID0gJ3dhcm5pbmcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICAgIHR5cGU6IG1lc3NhZ2V0eXBlLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHN0ciwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgQmFja1RvR3JvdXBMaXN0KCkgewogICAgICB0aGlzLiRlbWl0KCdCYWNrdG9Hcm91cExpc3QnKTsKICAgIH0sCiAgICBnZXRJbnZpdGVLZXkoKSB7CiAgICAgIGxldCBzdHI7CiAgICAgIGF4aW9zLnBvc3QoJy9hcGkvZ2VuZXJhdGUta2V5JywgeyBncm91cF9pZDogdGhpcy4kcHJvcHMuaW5mby5pZCB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHsKICAgICAgICAgIGlmIChyZXMuZGF0YS5zdGF0dXMpIHsKICAgICAgICAgICAgdGhpcy5pbnZpdGVrZXkubnVtID0gcmVzLmRhdGEuaW52aXRlX2tleTsKICAgICAgICAgICAgdGhpcy5pbnZpdGVrZXkuZXhfZGF0ZSA9IHJlcy5kYXRhLmtleV9leHBpcnlfZGF0ZTsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5pbnZpdGVrZXkpOwogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgICAgICAgc3RyID0gJ+aWsOeahOmCgOivt+eggeaYrycgKyB0aGlzLmludml0ZWtleS5udW0gKyAn77yM5bCG5LqOJyArIHRoaXMuaW52aXRla2V5LmV4X2RhdGUgKyAn6L+H5pyfJzsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHN0ciwKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBsZWF2ZUdyb3VwKCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgaWYgKGNvbmZpcm0oJ+ehruWumumAgOe+pO+8nycpKSB7CiAgICAgICAgYXhpb3MucG9zdCgnL2FwaS9sZWF2ZS1ncm91cCcsIHsKICAgICAgICAgIGdyb3VwX2lkOiB0aGlzLiRwcm9wcy5pbmZvLmlkLAogICAgICAgICAgdXNlcl9pZDogdGhpcy4kcm91dGUucGFyYW1zLnVzZXJpZCwKICAgICAgICB9KQogICAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tZW1wdHkKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN0YXR1cykgewogICAgICAgICAgICAgIHRoaXMuQmFja1RvR3JvdXBMaXN0KCk7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5oiQ5Yqf6YCA5Ye6576k57uEJywKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJywKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfml6Dms5XpgIDnvqQnLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgIH0pOwogICAgICB9CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuY2hlY2tBZG1pbigpOwogICAgY29uc29sZS5sb2codGhpcy4kcHJvcHMuaW5mbyk7CiAgfSwKfTsK"},{"version":3,"sources":["GroupPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"GroupPage.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-container>\n  <el-header>\n    <el-container>\n    <el-button\n      style=\"width: 50px;margin-right: 30px;\"\n      icon=\"el-icon-back\"\n      @click=\"BackToGroupList\" circle\n    type=\"primary\"></el-button>\n    <h1>{{this.$props.info.group_name}}\n    </h1>\n      <el-button  size=\"mini\" style=\"margin-left: 10px;margin-bottom: 1px;height: 25px;width: 25px;padding-left: 3px\" type=\"primary\" icon=\"el-icon-edit\" @click=\"changeGroupName\"></el-button>\n    </el-container>\n  </el-header>\n  <el-container>\n    <el-aside width=\"300px\">\n      <MemberList :info=\"this.$props.info\"></MemberList>\n    </el-aside>\n    <div id=\"elmain\">\n<!--    <el-main id=\"elmain\">-->\n      <GenealogyPage :info=\"this.$props.info\"></GenealogyPage>\n<!--    </el-main>-->\n    </div>\n  </el-container>\n      <el-button  style=\"position: absolute; bottom: 10px; right: 239px;\" v-if=\"this.$props.info.admin\" type=\"primary\" icon=\"el-icon-share\" @click=\"getInviteKey\">获取邀请码</el-button>\n      <el-button style=\"position: absolute; bottom: 10px; right: 124px;\" v-if=\"this.$props.info.admin\" type=\"danger\" icon=\"el-icon-delete\"  @click=\"DeleteGroup\">删除群</el-button>\n      <el-button  style=\"position: absolute; bottom: 10px; right: 10px;\" type=\"danger\" icon=\"el-icon-warning\" @click=\"leaveGroup\">退出群</el-button>\n</el-container>\n</template>\n\n<script>\nimport axios from 'axios';\nimport MemberList from './MemberList.vue';\nimport GenealogyPage from './GenealogyPage.vue';\n\nexport default {\n  name: 'GroupPage',\n  components: { GenealogyPage, MemberList },\n  Component: {\n    MemberList,\n    GenealogyPage,\n  },\n  props: {\n    info: {},\n  },\n  data() {\n    return {\n      userid: '',\n      invitekey: { num: '', ex_date: '' },\n    };\n  },\n  methods: {\n    changeGroupName() {\n      this.$prompt('为你的群改一个好听的名字', '群名更改', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n      }).then(({ value }) => {\n        if (value === null) {\n          // eslint-disable-next-line\n            value = '';\n        }\n        axios.post('/api/change-groupname', { group_id: this.$props.info.id, new_name: value })\n          .then((res) => {\n            // eslint-disable-next-line no-unused-vars\n            let str;\n            let messagetype;\n            if (res.data.status) {\n              messagetype = 'success';\n              str = `成功更改群名，名为：${value}`;\n              this.$props.info.group_name = value;\n              // eslint-disable-next-line no-empty\n            } else {\n              str = '更改失败';\n              messagetype = 'warning';\n            }\n            this.$message({\n              type: messagetype,\n              message: str,\n            });\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '取消输入',\n        });\n      });\n    },\n    checkAdmin() {\n      axios.post('/api/query-admin', { group_id: this.$props.info.id, user_id: this.$route.params.userid })\n        .then((res) => {\n          if (res.data.status) {\n            this.$props.info.admin = res.data.admin;\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    DeleteGroup() {\n      // eslint-disable-next-line\n      if (confirm('确定删除群？')) {\n        axios.post('/api/delete-group', { group_id: this.$props.info.id })\n          .then((res) => {\n            let str;\n            let messagetype;\n            if (res.data.status) {\n              str = '成功删除群';\n              messagetype = 'success';\n              this.$emit('BacktoGroupList');\n            } else {\n              str = '删除群失败';\n              messagetype = 'warning';\n            }\n            this.$message({\n              type: messagetype,\n              message: str,\n            });\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    },\n    BackToGroupList() {\n      this.$emit('BacktoGroupList');\n    },\n    getInviteKey() {\n      let str;\n      axios.post('/api/generate-key', { group_id: this.$props.info.id })\n        .then((res) => {\n          if (res.data.status) {\n            this.invitekey.num = res.data.invite_key;\n            this.invitekey.ex_date = res.data.key_expiry_date;\n            console.log(this.invitekey);\n            // eslint-disable-next-line\n            str = '新的邀请码是' + this.invitekey.num + '，将于' + this.invitekey.ex_date + '过期';\n            this.$message({\n              type: 'success',\n              message: str,\n            });\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    leaveGroup() {\n      // eslint-disable-next-line\n      if (confirm('确定退群？')) {\n        axios.post('/api/leave-group', {\n          group_id: this.$props.info.id,\n          user_id: this.$route.params.userid,\n        })\n          .then((res) => {\n            // eslint-disable-next-line no-empty\n            if (res.data.status) {\n              this.BackToGroupList();\n              this.$message({\n                type: 'success',\n                message: '成功退出群组',\n              });\n            } else {\n              this.$message({\n                type: 'warning',\n                message: '无法退群',\n              });\n            }\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    },\n  },\n  created() {\n    this.checkAdmin();\n    console.log(this.$props.info);\n  },\n};\n</script>\n\n<style scoped>\n#elmain{\n  /*position: absolute;*/\n  margin-top: -40px;\n  margin-left: 5px;\n  width: 100%;\n  height: 100%;\n}\n</style>\n"]}]}