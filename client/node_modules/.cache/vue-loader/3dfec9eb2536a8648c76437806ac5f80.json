{"remainingRequest":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\src\\components\\GroupPage.vue?vue&type=style&index=0&id=fc6432a4&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\src\\components\\GroupPage.vue","mtime":1640180189046},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1640180100267},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1640180123445},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":1640099129881},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640099097496},{"path":"C:\\Users\\trans\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1640180123441}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgojZWxtYWluewogIC8qcG9zaXRpb246IGFic29sdXRlOyovCiAgbWFyZ2luLXRvcDogLTQwcHg7CiAgbWFyZ2luLWxlZnQ6IDVweDsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDEwMCU7Cn0K"},{"version":3,"sources":["GroupPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;AACA;AACA;AACA;AACA;AACA;AACA","file":"GroupPage.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-container>\n  <el-header>\n    <el-container>\n    <el-button\n      style=\"width: 50px;margin-right: 30px;\"\n      icon=\"el-icon-back\"\n      @click=\"BackToGroupList\" circle\n    type=\"primary\"></el-button>\n    <h1>{{this.$props.info.group_name}}\n    </h1>\n      <el-button  size=\"mini\" style=\"margin-left: 10px;margin-bottom: 1px;height: 25px;width: 25px;padding-left: 3px\" type=\"primary\" icon=\"el-icon-edit\" @click=\"changeGroupName\"></el-button>\n    </el-container>\n  </el-header>\n  <el-container>\n    <el-aside width=\"300px\">\n      <MemberList :info=\"this.$props.info\"></MemberList>\n    </el-aside>\n    <div id=\"elmain\">\n<!--    <el-main id=\"elmain\">-->\n      <GenealogyPage :info=\"this.$props.info\"></GenealogyPage>\n<!--    </el-main>-->\n    </div>\n  </el-container>\n      <el-button  style=\"position: absolute; bottom: 10px; right: 239px;\" v-if=\"this.$props.info.admin\" type=\"primary\" icon=\"el-icon-share\" @click=\"getInviteKey\">获取邀请码</el-button>\n      <el-button style=\"position: absolute; bottom: 10px; right: 124px;\" v-if=\"this.$props.info.admin\" type=\"danger\" icon=\"el-icon-delete\"  @click=\"DeleteGroup\">删除群</el-button>\n      <el-button  style=\"position: absolute; bottom: 10px; right: 10px;\" type=\"danger\" icon=\"el-icon-warning\" @click=\"leaveGroup\">退出群</el-button>\n</el-container>\n</template>\n\n<script>\nimport axios from 'axios';\nimport MemberList from './MemberList.vue';\nimport GenealogyPage from './GenealogyPage.vue';\n\nexport default {\n  name: 'GroupPage',\n  components: { GenealogyPage, MemberList },\n  Component: {\n    MemberList,\n    GenealogyPage,\n  },\n  props: {\n    info: {},\n  },\n  data() {\n    return {\n      userid: '',\n      invitekey: { num: '', ex_date: '' },\n    };\n  },\n  methods: {\n    changeGroupName() {\n      this.$prompt('为你的群改一个好听的名字', '群名更改', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n      }).then(({ value }) => {\n        if (value === null) {\n          // eslint-disable-next-line\n            value = '';\n        }\n        axios.post('/api/change-groupname', { group_id: this.$props.info.id, new_name: value })\n          .then((res) => {\n            // eslint-disable-next-line no-unused-vars\n            let str;\n            let messagetype;\n            if (res.data.status) {\n              messagetype = 'success';\n              str = `成功更改群名，名为：${value}`;\n              this.$props.info.group_name = value;\n              // eslint-disable-next-line no-empty\n            } else {\n              str = '更改失败';\n              messagetype = 'warning';\n            }\n            this.$message({\n              type: messagetype,\n              message: str,\n            });\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '取消输入',\n        });\n      });\n    },\n    checkAdmin() {\n      axios.post('/api/query-admin', { group_id: this.$props.info.id, user_id: this.$route.params.userid })\n        .then((res) => {\n          if (res.data.status) {\n            this.$props.info.admin = res.data.admin;\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    DeleteGroup() {\n      // eslint-disable-next-line\n      if (confirm('确定删除群？')) {\n        axios.post('/api/delete-group', { group_id: this.$props.info.id })\n          .then((res) => {\n            let str;\n            let messagetype;\n            if (res.data.status) {\n              str = '成功删除群';\n              messagetype = 'success';\n              this.$emit('BacktoGroupList');\n            } else {\n              str = '删除群失败';\n              messagetype = 'warning';\n            }\n            this.$message({\n              type: messagetype,\n              message: str,\n            });\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    },\n    BackToGroupList() {\n      this.$emit('BacktoGroupList');\n    },\n    getInviteKey() {\n      let str;\n      axios.post('/api/generate-key', { group_id: this.$props.info.id })\n        .then((res) => {\n          if (res.data.status) {\n            this.invitekey.num = res.data.invite_key;\n            this.invitekey.ex_date = res.data.key_expiry_date;\n            console.log(this.invitekey);\n            // eslint-disable-next-line\n            str = '新的邀请码是' + this.invitekey.num + '，将于' + this.invitekey.ex_date + '过期';\n            this.$message({\n              type: 'success',\n              message: str,\n            });\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    leaveGroup() {\n      // eslint-disable-next-line\n      if (confirm('确定退群？')) {\n        axios.post('/api/leave-group', {\n          group_id: this.$props.info.id,\n          user_id: this.$route.params.userid,\n        })\n          .then((res) => {\n            // eslint-disable-next-line no-empty\n            if (res.data.status) {\n              this.BackToGroupList();\n              this.$message({\n                type: 'success',\n                message: '成功退出群组',\n              });\n            } else {\n              this.$message({\n                type: 'warning',\n                message: '无法退群',\n              });\n            }\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n      }\n    },\n  },\n  created() {\n    this.checkAdmin();\n    console.log(this.$props.info);\n  },\n};\n</script>\n\n<style scoped>\n#elmain{\n  /*position: absolute;*/\n  margin-top: -40px;\n  margin-left: 5px;\n  width: 100%;\n  height: 100%;\n}\n</style>\n"]}]}