{"remainingRequest":"C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\src\\components\\GroupPage.vue?vue&type=style&index=0&id=fc6432a4&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\src\\components\\GroupPage.vue","mtime":1640167717753},{"path":"C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1640165329170},{"path":"C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1640165341319},{"path":"C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":1640165336647},{"path":"C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1640165327016},{"path":"C:\\Users\\Laggy pc\\Documents\\GitHub\\SoftwareEngineeringB11\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1640165341316}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KI2VsbWFpbnsNCiAgLypwb3NpdGlvbjogYWJzb2x1dGU7Ki8NCiAgbWFyZ2luLXRvcDogLTQwcHg7DQogIG1hcmdpbi1sZWZ0OiA1cHg7DQogIHdpZHRoOiAxMDAlOw0KICBoZWlnaHQ6IDEwMCU7DQp9DQo="},{"version":3,"sources":["GroupPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;AACA;AACA;AACA;AACA;AACA;AACA","file":"GroupPage.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <el-container>\r\n  <el-header>\r\n    <el-container>\r\n    <el-button\r\n      style=\"width: 50px;margin-right: 30px;\"\r\n      icon=\"el-icon-back\"\r\n      @click=\"BackToGroupList\" circle\r\n    type=\"primary\"></el-button>\r\n    <h1>{{this.$props.info.group_name}}\r\n    </h1>\r\n      <el-button  size=\"mini\" style=\"margin-left: 10px;margin-bottom: 1px;height: 25px;width: 25px;padding-left: 3px\" type=\"primary\" icon=\"el-icon-edit\" @click=\"changeGroupName\"></el-button>\r\n    </el-container>\r\n  </el-header>\r\n  <el-container>\r\n    <el-aside width=\"300px\">\r\n      <MemberList :info=\"this.$props.info\"></MemberList>\r\n    </el-aside>\r\n    <div id=\"elmain\">\r\n<!--    <el-main id=\"elmain\">-->\r\n      <GenealogyPage :info=\"this.$props.info\"></GenealogyPage>\r\n<!--    </el-main>-->\r\n    </div>\r\n  </el-container>\r\n      <el-button  style=\"position: absolute; bottom: 10px; right: 239px;\" v-if=\"this.$props.info.admin\" type=\"primary\" icon=\"el-icon-share\" @click=\"getInviteKey\">获取邀请码</el-button>\r\n      <el-button style=\"position: absolute; bottom: 10px; right: 124px;\" v-if=\"this.$props.info.admin\" type=\"danger\" icon=\"el-icon-delete\"  @click=\"DeleteGroup\">删除群</el-button>\r\n      <el-button  style=\"position: absolute; bottom: 10px; right: 10px;\" type=\"danger\" icon=\"el-icon-warning\" @click=\"leaveGroup\">退出群</el-button>\r\n</el-container>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport MemberList from './MemberList.vue';\r\nimport GenealogyPage from './GenealogyPage.vue';\r\n\r\nexport default {\r\n  name: 'GroupPage',\r\n  components: { GenealogyPage, MemberList },\r\n  Component: {\r\n    MemberList,\r\n    GenealogyPage,\r\n  },\r\n  props: {\r\n    info: {},\r\n  },\r\n  data() {\r\n    return {\r\n      userid: '',\r\n      invitekey: { num: '', ex_date: '' },\r\n    };\r\n  },\r\n  methods: {\r\n    changeGroupName() {\r\n      this.$prompt('为你的群改一个好听的名字', '群名更改', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n      }).then(({ value }) => {\r\n        if (value === null) {\r\n          // eslint-disable-next-line\r\n            value = '';\r\n        }\r\n        axios.post('/api/change-groupname', { group_id: this.$props.info.id, new_name: value })\r\n          .then((res) => {\r\n            // eslint-disable-next-line no-unused-vars\r\n            let str;\r\n            let messagetype;\r\n            if (res.data.status) {\r\n              messagetype = 'success';\r\n              str = `成功更改群名，名为：${value}`;\r\n              this.$props.info.group_name = value;\r\n              // eslint-disable-next-line no-empty\r\n            } else {\r\n              str = '更改失败';\r\n              messagetype = 'warning';\r\n            }\r\n            this.$message({\r\n              type: messagetype,\r\n              message: str,\r\n            });\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }).catch(() => {\r\n        this.$message({\r\n          type: 'info',\r\n          message: '取消输入',\r\n        });\r\n      });\r\n    },\r\n    checkAdmin() {\r\n      axios.post('/api/query-admin', { group_id: this.$props.info.id, user_id: this.$route.params.userid })\r\n        .then((res) => {\r\n          if (res.data.status) {\r\n            this.$props.info.admin = res.data.admin;\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    DeleteGroup() {\r\n      // eslint-disable-next-line\r\n      if (confirm('确定删除群？')) {\r\n        axios.post('/api/delete-group', { group_id: this.$props.info.id })\r\n          .then((res) => {\r\n            let str;\r\n            let messagetype;\r\n            if (res.data.status) {\r\n              str = '成功删除群';\r\n              messagetype = 'success';\r\n              this.$emit('BacktoGroupList');\r\n            } else {\r\n              str = '删除群失败';\r\n              messagetype = 'warning';\r\n            }\r\n            this.$message({\r\n              type: messagetype,\r\n              message: str,\r\n            });\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n    },\r\n    BackToGroupList() {\r\n      this.$emit('BacktoGroupList');\r\n    },\r\n    getInviteKey() {\r\n      let str;\r\n      axios.post('/api/generate-key', { group_id: this.$props.info.id })\r\n        .then((res) => {\r\n          if (res.data.status) {\r\n            this.invitekey.num = res.data.invite_key;\r\n            this.invitekey.ex_date = res.data.key_expiry_date;\r\n            console.log(this.invitekey);\r\n            // eslint-disable-next-line\r\n            str = '新的邀请码是' + this.invitekey.num + '，将于' + this.invitekey.ex_date + '过期';\r\n            this.$message({\r\n              type: 'success',\r\n              message: str,\r\n            });\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    leaveGroup() {\r\n      // eslint-disable-next-line\r\n      if (confirm('确定退群？')) {\r\n        axios.post('/api/leave-group', {\r\n          group_id: this.$props.info.id,\r\n          user_id: this.$route.params.userid,\r\n        })\r\n          .then((res) => {\r\n            // eslint-disable-next-line no-empty\r\n            if (res.data.status) {\r\n              this.BackToGroupList();\r\n              this.$message({\r\n                type: 'success',\r\n                message: '成功退出群组',\r\n              });\r\n            } else {\r\n              this.$message({\r\n                type: 'warning',\r\n                message: '无法退群',\r\n              });\r\n            }\r\n          })\r\n          .catch((err) => {\r\n            console.log(err);\r\n          });\r\n      }\r\n    },\r\n  },\r\n  created() {\r\n    this.checkAdmin();\r\n    console.log(this.$props.info);\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n#elmain{\r\n  /*position: absolute;*/\r\n  margin-top: -40px;\r\n  margin-left: 5px;\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n</style>\r\n"]}]}